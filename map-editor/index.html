<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS 地图编辑器</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- 顶部工具栏 -->
        <div id="toolbar">
            <div class="toolbar-section">
                <span class="toolbar-title">CS 地图编辑器</span>
            </div>
            <div class="toolbar-section">
                <button id="newMap" class="tool-btn">新建</button>
                <button id="saveMap" class="tool-btn primary">保存JSON</button>
                <button id="exportCode" class="tool-btn">导出代码</button>
                <button id="loadMap" class="tool-btn">加载文件</button>
                <button id="loadPreset" class="tool-btn">预设地图</button>
                <button id="testMap" class="tool-btn">测试视角</button>
            </div>
            <div class="toolbar-section">
                <button id="addFloor" class="tool-btn">一键铺地板</button>
                <button id="addWalls" class="tool-btn">一键围墙</button>
                <button id="rotateMap90" class="tool-btn">🔄 整体旋转90°</button>
                <button id="eraserTool" class="tool-btn">🧹 橡皮擦</button>
                <button id="undoBtn" class="tool-btn">↩ 撤回</button>
            </div>
            <div class="toolbar-section">
                <label>地图ID: <input type="text" id="mapName" value="custom_map" style="width:100px;" /></label>
                <label>显示名称: <input type="text" id="mapDisplayName" value="自定义地图" /></label>
                <label>地图大小: <input type="number" id="mapSize" value="300" min="100" max="500" style="width:80px;" /></label>
                <label>游戏模式: 
                    <select id="gameMode" multiple size="2">
                        <option value="deathmatch">团队竞技</option>
                        <option value="defuse">爆破模式</option>
                    </select>
                </label>
            </div>
        </div>

        <!-- 预设地图选择弹窗 -->
        <div id="preset-modal" class="modal">
            <div class="modal-content" style="width:400px;">
                <h3>选择预设地图</h3>
                <div id="preset-list">
                    <div class="preset-item" data-map="desert_map">
                        <div class="preset-icon">🏜️</div>
                        <div class="preset-info">
                            <div class="preset-name">沙漠竞技场</div>
                            <div class="preset-desc">沙漠风格对战地图</div>
                        </div>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button id="close-preset-modal" class="tool-btn">取消</button>
                </div>
            </div>
        </div>

        <!-- 主内容区容器 -->
        <div id="main-content">
            <!-- 左侧物件面板 -->
            <div id="sidebar">
            <h3>物件列表</h3>
            <div class="object-category">
                <h4>基础建筑</h4>
                <div class="object-item" data-type="floor" draggable="true">
                    <div class="preview floor"></div>
                    <span>地板</span>
                </div>
                <div class="object-item" data-type="wall" draggable="true">
                    <div class="preview wall"></div>
                    <span>墙面</span>
                </div>
                <div class="object-item" data-type="box" draggable="true">
                    <div class="preview box"></div>
                    <span>箱子</span>
                </div>
                <div class="object-item" data-type="crate" draggable="true">
                    <div class="preview crate"></div>
                    <span>木箱</span>
                </div>
                <div class="object-item" data-type="door" draggable="true">
                    <div class="preview door"></div>
                    <span>门</span>
                </div>
            </div>
            
            <div class="object-category">
                <h4>游戏点位</h4>
                <div class="object-item" data-type="bombsite_a" draggable="true">
                    <div class="preview site-a"></div>
                    <span>A点</span>
                </div>
                <div class="object-item" data-type="bombsite_b" draggable="true">
                    <div class="preview site-b"></div>
                    <span>B点</span>
                </div>
                <div class="object-item" data-type="spawn_ct" draggable="true">
                    <div class="preview spawn-ct"></div>
                    <span>CT复活点</span>
                </div>
                <div class="object-item" data-type="spawn_t" draggable="true">
                    <div class="preview spawn-t"></div>
                    <span>T复活点</span>
                </div>
            </div>
            
            <div class="object-category">
                <h4>装饰物</h4>
                <div class="object-item" data-type="barrel" draggable="true">
                    <div class="preview barrel"></div>
                    <span>油桶</span>
                </div>
                <div class="object-item" data-type="sandbag" draggable="true">
                    <div class="preview sandbag"></div>
                    <span>沙袋</span>
                </div>
                <div class="object-item" data-type="graffiti" draggable="true">
                    <div class="preview graffiti"></div>
                    <span>涂鸦</span>
                </div>
                <div class="object-item" data-type="light" draggable="true">
                    <div class="preview light"></div>
                    <span>灯光</span>
                </div>
            </div>
        </div>

        <!-- 3D 视图 -->
        <div id="viewport">
            <canvas id="canvas"></canvas>
            <div id="coords">X: 0, Y: 0, Z: 0</div>
            <div id="help">
                WASD: 移动 | 鼠标右键: 旋转视角 | 滚轮: 缩放 | 左键: 选择/放置 | Delete: 删除 | R: 旋转物件
            </div>
        </div>

        <!-- 右侧属性面板 -->
        <div id="properties">
            <h3>属性</h3>
            <div id="no-selection">未选中物件</div>
            <div id="prop-panel" style="display:none;">
                <div class="prop-group">
                    <label>类型</label>
                    <span id="prop-type">-</span>
                </div>
                <div class="prop-group">
                    <label>位置 X</label>
                    <input type="number" id="prop-x" step="1" />
                </div>
                <div class="prop-group">
                    <label>位置 Y</label>
                    <input type="number" id="prop-y" step="1" />
                </div>
                <div class="prop-group">
                    <label>位置 Z</label>
                    <input type="number" id="prop-z" step="1" />
                </div>
                <div class="prop-group">
                    <label>宽度</label>
                    <input type="number" id="prop-w" step="1" min="1" />
                </div>
                <div class="prop-group">
                    <label>高度</label>
                    <input type="number" id="prop-h" step="1" min="1" />
                </div>
                <div class="prop-group">
                    <label>深度</label>
                    <input type="number" id="prop-d" step="1" min="1" />
                </div>
                <div class="prop-group">
                    <label>旋转 Y</label>
                    <input type="number" id="prop-ry" step="15" />
                </div>
                <div class="prop-group">
                    <label>颜色</label>
                    <input type="color" id="prop-color" />
                </div>
                <button id="delete-obj" class="tool-btn danger">删除物件</button>
                <button id="duplicate-obj" class="tool-btn">复制物件</button>
            </div>
        </div>
        </div><!-- 关闭 main-content -->

        <!-- 代码输出弹窗 -->
        <div id="code-modal" class="modal">
            <div class="modal-content">
                <h3>地图代码</h3>
                <p>复制以下代码到 maps.js 的 MAP_CONFIGS 中即可使用</p>
                <textarea id="code-output" readonly></textarea>
                <div class="modal-buttons">
                    <button id="copy-code" class="tool-btn primary">复制代码</button>
                    <button id="close-modal" class="tool-btn">关闭</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="editor.js"></script>
</body>
</html>
