<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="screen-orientation" content="landscape">
<meta name="x5-orientation" content="landscape">
<meta name="full-screen" content="yes">
<meta name="x5-fullscreen" content="true">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="CS 1.6">
<meta name="mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" href="image/icon.png">
<title>CS 1.6 像素版 3D</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect fill='%23333' width='32' height='32' rx='4'/><text x='16' y='22' font-size='16' font-family='Arial' font-weight='bold' fill='%23ff6600' text-anchor='middle'>CS</text></svg>">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="pixel-toast-overlay"></div>
<div id="pixel-toast">
<div class="pixel-toast-header">
<span class="pixel-toast-icon">📢</span>
<span class="pixel-toast-title">提示</span>
</div>
<div class="pixel-toast-body">消息内容</div>
<button class="pixel-toast-btn">确定</button>
</div>
<div id="ios-pwa-prompt" style="display: none;">
<div class="ios-prompt-content">
<div class="ios-prompt-close" id="ios-prompt-close">×</div>
<div class="ios-prompt-icon">📱</div>
<div class="ios-prompt-title">全屏游玩指南</div>
<div class="ios-prompt-text">
<b>添加到主屏幕：</b><br>
点击 <b>共享</b> → <b>添加到主屏幕</b>
</div>
<div class="ios-prompt-text" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.1);">
<b>开启120Hz高刷：</b><br>
设置 → Safari → 高级 → 功能标志<br>
关闭「Prefer Page Rendering Updates near 60fps」<br>
重启Safari生效
</div>
<button id="ios-prompt-dismiss" class="ios-prompt-btn">知道了</button>
</div>
</div>
<div id="rotate-screen-hint">
<div class="rotate-icon">📱</div>
<div>请将手机横屏</div>
<div style="font-size: 16px; margin-top: 10px; opacity: 0.7;">以获得最佳游戏体验</div>
</div>
<div id="pixel-bg">
<canvas id="pixel-canvas"></canvas>
</div>
<div id="editor-link">
<a href="map-editor/index.html" class="editor-btn" title="地图编辑器">🗺️</a>
</div>
<div id="music-control">
<button id="music-toggle" class="music-btn">🔊</button>
</div>
<div id="menu">
<div id="mobile-drawer-btns">
<button id="drawer-help-btn" class="drawer-toggle-btn">🎮</button>
<button id="drawer-rooms-btn" class="drawer-toggle-btn">🌐</button>
<button id="drawer-news-btn" class="drawer-toggle-btn">📢</button>
</div>
<div id="mobile-drawer" class="drawer-hidden">
<div class="drawer-header">
<span id="drawer-title">标题</span>
<button id="drawer-close" class="drawer-close-btn">✕</button>
</div>
<div id="drawer-content"></div>
</div>
<div id="drawer-overlay"></div>
<div class="menu-wrapper">
<div class="info-card gameplay-card">
<h3>🎮 游戏玩法</h3>
<div class="gameplay-content">
<div class="control-section">
<h4>🎯 基础操作</h4>
<p><span class="key">W A S D</span> 移动</p>
<p><span class="key">鼠标</span> 视角控制</p>
<p><span class="key">左键</span> 射击/攻击</p>
<p><span class="key">右键</span> 开镜 (AWP)</p>
<p><span class="key">滚轮</span> 切换武器</p>
</div>
<div class="control-section">
<h4>🏃 进阶操作</h4>
<p><span class="key">空格</span> 跳跃</p>
<p><span class="key">Ctrl</span> 下蹲</p>
<p><span class="key">R</span> 换弹</p>
<p><span class="key">Q</span> 快速切枪</p>
<p><span class="key">E</span> 拆弹/安装C4</p>
</div>
<div class="control-section">
<h4>🔫 武器切换</h4>
<p><span class="key">1</span> 主武器 (AK/M4/AWP)</p>
<p><span class="key">2</span> 副武器 (手枪)</p>
<p><span class="key">3</span> 近战武器 (刀)</p>
<p><span class="key">4</span> 投掷物 (手雷)</p>
<p><span class="key">5</span> C4炸弹 (T阵营)</p>
</div>
<div class="control-section">
<h4>⚙️ 系统功能</h4>
<p><span class="key">B</span> 购买武器菜单</p>
<p><span class="key">Tab</span> 查看战绩</p>
<p><span class="key">ESC</span> 设置/暂停</p>
<p><span class="key">G</span> 丢弃武器（待开发）</p>
</div>
<div class="control-section">
<h4>💡 游戏提示</h4>
<p>• 爆头伤害翻倍</p>
<p>• 蹲下射击更精准</p>
<p>• AWP可双击右键二倍镜</p>
<p>• 连杀会有特殊音效</p>
</div>
</div>
</div>
<div class="menu-container">
<h1 class="pixel-title">CS 1.6</h1>
<h2 class="pixel-subtitle">3D 像素版</h2>
<div class="tab-buttons">
<button type="button" id="tabJoin" class="tab-btn active">加入房间</button>
<button type="button" id="tabCreate" class="tab-btn">创建房间</button>
</div>
<div class="input-group">
<label>玩家名称 (2-8字符)</label>
<input type="text" id="playerName" placeholder="输入名称" maxlength="8" minlength="2">
</div>
<div class="input-group">
<label>房间号 (8字符)</label>
<input type="text" id="roomId" placeholder="输入8位房间号" maxlength="8">
</div>
<div id="createOptions" style="display: none;">
<div class="input-group">
<label>游戏模式</label>
<div class="pixel-select-wrapper">
<select id="gameMode" class="pixel-select">
<option value="deathmatch">团队竞技 (10分钟)</option>
<option value="defuse">爆破模式 (回合制)</option>
<option value="custom">自定义地图</option>
</select>
</div>
</div>
<div class="input-group" id="targetKillsGroup">
<label>目标击杀数</label>
<div class="pixel-select-wrapper">
<select id="targetKills" class="pixel-select">
<option value="10">10 击杀</option>
<option value="20" selected>20 击杀</option>
<option value="30">30 击杀</option>
<option value="50">50 击杀</option>
<option value="100">100 击杀</option>
</select>
</div>
</div>
<div class="input-group" id="customMapGroup" style="display: none;">
<label>导入地图</label>
<div class="custom-map-options">
<input type="file" id="customMapFile" accept=".json" style="display: none;">
<button type="button" id="importMapBtn" class="pixel-btn small">📁 本地文件</button>
<button type="button" id="cloudMapBtn" class="pixel-btn small">☁️ 云端地图</button>
</div>
<span id="customMapName" style="margin-top: 8px; display: block; color: #888;">未选择地图</span>
</div>
<div class="input-group" id="mapSelectGroup">
<label>选择地图</label>
<div class="pixel-select-wrapper">
<select id="mapSelect" class="pixel-select">
</select>
</div>
</div>
</div>
<div class="input-group">
<label>选择阵营 (每队最多8人)</label>
<div class="team-select">
<button type="button" id="teamCT" class="team-btn ct-btn active">反恐精英 (CT)</button>
<button type="button" id="teamT" class="team-btn t-btn">恐怖分子 (T)</button>
</div>
</div>
<div class="input-group server-config">
<label>服务器地址 <span class="optional">(可选)</span></label>
<div class="server-input-group">
<input type="text" id="serverUrl" placeholder="ws://服务器地址:端口">
<button type="button" id="saveServerBtn" class="pixel-btn small">保存</button>
</div>
<span id="currentServer" class="server-hint"></span>
</div>
<button id="joinBtn" class="pixel-btn">加入游戏</button>
<button id="createBtn" class="pixel-btn" style="display: none;">创建房间</button>
<div id="welcome-banner" class="welcome-banner">
<div class="scanline"></div>
<div class="welcome-text">
<span class="welcome-line1">🎮 WELCOME TO 🎮</span>
<span class="welcome-line2">CS 1.6 像素版-阿里云参赛作品</span>
<span class="welcome-line3">
<span class="pixel-star">✦</span>
新年快乐 2026
<span class="pixel-star">✦</span>
</span>
</div>
</div>
</div>
<div class="right-cards">
<div class="info-card public-rooms-card">
<h3>🌐 公开房间</h3>
<div class="public-rooms-grid" id="public-rooms-grid">
<button class="public-room-btn defuse" data-room="DEFUSE01" data-mode="defuse" data-map="dust2">
<span class="room-name">爆破1号</span>
<span class="room-map">沙漠灰</span>
<span class="room-players" id="room-DEFUSE01-players">0/16</span>
</button>
<button class="public-room-btn defuse" data-room="DEFUSE02" data-mode="defuse" data-map="dust2">
<span class="room-name">爆破2号</span>
<span class="room-map">沙漠灰</span>
<span class="room-players" id="room-DEFUSE02-players">0/16</span>
</button>
<button class="public-room-btn defuse" data-room="DEFUSE03" data-mode="defuse" data-map="dust2">
<span class="room-name">爆破3号</span>
<span class="room-map">沙漠灰</span>
<span class="room-players" id="room-DEFUSE03-players">0/16</span>
</button>
<button class="public-room-btn deathmatch" data-room="TEAM0001" data-mode="deathmatch" data-map="indoor">
<span class="room-name">竞技1号</span>
<span class="room-map">室内竞技场</span>
<span class="room-players" id="room-TEAM0001-players">0/16</span>
</button>
<button class="public-room-btn deathmatch" data-room="TEAM0002" data-mode="deathmatch" data-map="indoor">
<span class="room-name">竞技2号</span>
<span class="room-map">室内竞技场</span>
<span class="room-players" id="room-TEAM0002-players">0/16</span>
</button>
<button class="public-room-btn deathmatch" data-room="TEAM0003" data-mode="deathmatch" data-map="indoor">
<span class="room-name">竞技3号</span>
<span class="room-map">室内竞技场</span>
<span class="room-players" id="room-TEAM0003-players">0/16</span>
</button>
</div>
</div>
<div class="info-card announcement-card">
<h3>📢 游戏公告</h3>
<div id="announcement-content" class="announcement-content">
<p class="loading-text">正在加载公告...</p>
</div>
</div>
</div>
</div>
</div>
<div id="game" style="display: none;">
<div id="crosshair">+</div>
<div id="crosshair-target"></div>
<div id="scope" style="display: none;">
<div id="scope-red-dot"></div>
</div>
<div id="kill-feedback">
<div id="kill-icon"></div>
<div id="kill-streak-icon"></div>
</div>
<div id="top-hud">
<div id="ct-score" class="team-score ct">反恐精英: 0</div>
<div id="game-info">
<span id="game-timer" style="display: none;">10:00</span>
<span id="game-mode-text"></span>
<span id="round-info" style="display: none;">回合 <span id="current-round">1</span>/<span id="max-rounds">10</span></span>
<span id="deathmatch-info">目标: <span id="target-kills">20</span> 击杀 | </span>
<span id="map-name">沙漠2</span>
</div>
<div id="t-score" class="team-score t">恐怖分子: 0</div>
</div>
<div id="defuse-hud" style="display: none;">
<div id="c4-status"></div>
<div id="c4-timer-display" style="display: none;">
<span class="c4-icon">💣</span>
<span id="c4-countdown">40</span>
</div>
<div id="defuse-progress-container" style="display: none;">
<div id="defuse-progress-bar"><div id="defuse-progress"></div></div>
<span id="defuse-text">拆弹中...</span>
</div>
<div id="plant-progress-container" style="display: none;">
<div id="plant-progress-bar"><div id="plant-progress"></div></div>
<span id="plant-text">安放C4中...</span>
</div>
<div id="plant-hint" style="display: none;">按 E 或 鼠标左键 安放C4</div>
<div id="defuse-hint" style="display: none;">按住 E 拆除C4</div>
</div>
<div id="spectator-ui" style="display: none;">
<div id="spectator-info">
<span id="spectator-label">👁 观战中</span>
<span id="spectator-name">队友</span>
</div>
<div id="spectator-hint">鼠标左键切换观战目标</div>
</div>
<div id="bomb-site-a" class="bomb-site-marker" style="display: none;">A</div>
<div id="bomb-site-b" class="bomb-site-marker" style="display: none;">B</div>
<div id="round-end-screen" style="display: none;">
<div id="round-winner"></div>
<div id="round-reason"></div>
<div id="round-score"></div>
</div>
<div id="freeze-time-overlay" style="display: none;">
<div id="freeze-countdown">准备阶段</div>
</div>
<div id="fps-counter"><span id="fps-text">FPS: 0</span> | <span id="ping-text" style="color: #4ade80;">延迟: --ms</span></div>
<div id="mobile-controls" style="display: none;">
<div id="joystick-container">
<div id="joystick-base">
<div id="joystick-stick"></div>
</div>
</div>
<div id="mobile-buttons">
<button id="mobile-shoot" class="mobile-btn shoot-btn">🔫</button>
<button id="mobile-scope" class="mobile-btn scope-btn">🎯</button>
<button id="mobile-reload" class="mobile-btn">换弹</button>
<button id="mobile-jump" class="mobile-btn">跳</button>
<button id="mobile-crouch" class="mobile-btn">蹲</button>
<button id="mobile-switch" class="mobile-btn">切枪</button>
<button id="mobile-buy" class="mobile-btn">购买</button>
<button id="mobile-settings" class="mobile-btn">⚙</button>
<button id="mobile-scoreboard" class="mobile-btn">战绩</button>
</div>
<button id="mobile-defuse" class="mobile-btn defuse-btn" style="display: none;">拆包</button>
<div id="mobile-weapon-bar">
<button class="weapon-slot" data-slot="1">1</button>
<button class="weapon-slot" data-slot="2">2</button>
<button class="weapon-slot" data-slot="3">🔪</button>
<button class="weapon-slot" data-slot="4">💣</button>
<button class="weapon-slot" data-slot="5">C4</button>
</div>
</div>
<div id="scoreboard-panel">
<h3>战绩面板</h3>
<div class="scoreboard-teams">
<div class="scoreboard-team" id="scoreboard-ct">
<div class="scoreboard-team-header ct">反恐精英 (CT) - <span id="scoreboard-ct-score">0</span></div>
<div class="scoreboard-stats-header">
<span style="flex:1;text-align:left;">玩家</span>
<span>K</span>
<span>D</span>
<span>HP</span>
</div>
<div id="scoreboard-ct-players"></div>
</div>
<div class="scoreboard-team" id="scoreboard-t">
<div class="scoreboard-team-header t">恐怖分子 (T) - <span id="scoreboard-t-score">0</span></div>
<div class="scoreboard-stats-header">
<span style="flex:1;text-align:left;">玩家</span>
<span>K</span>
<span>D</span>
<span>HP</span>
</div>
<div id="scoreboard-t-players"></div>
</div>
</div>
</div>
<div id="hud">
<div id="health">HP: 100</div>
<div id="weapon">AK-47</div>
<div id="score">K: 0 / D: 0</div>
</div>
<div id="killfeed"></div>
<div id="settings-menu" style="display: none;">
<h3>游戏设置</h3>
<div class="settings-group">
<label>鼠标灵敏度: <span id="sens-value">5</span></label>
<input type="range" id="sensitivity-slider" min="1" max="10" value="5" step="0.5">
</div>
<div class="settings-group">
<label>开镜灵敏度: <span id="scope-sens-value">3</span></label>
<input type="range" id="scope-sensitivity-slider" min="1" max="10" value="3" step="0.5">
</div>
<div class="settings-group">
<label>音效音量: <span id="volume-value">100</span>%</label>
<input type="range" id="volume-slider" min="0" max="100" value="100" step="5">
</div>
<div class="settings-buttons">
<button id="resumeGame" class="settings-btn">返回游戏</button>
<button id="toggleFullscreen" class="settings-btn">切换全屏</button>
<button id="exitGame" class="settings-btn exit-btn">退出游戏</button>
</div>
</div>
<div id="death-overlay"></div>
<div id="death-screen" style="display: none;">
<p>你已阵亡</p>
<p id="respawn-info"><span id="respawn-countdown">3</span> 秒后自动复活</p>
</div>
<div id="buy-menu" style="display: none;">
<h3>选择主武器 (按B关闭)</h3>
<div class="buy-options">
<button class="buy-btn" data-weapon="ak47">
<img src="image/ak47.jpg" alt="AK-47" class="weapon-img">
<span class="weapon-name">1. AK-47</span>
<span class="weapon-desc">高伤害 | 30发</span>
</button>
<button class="buy-btn" data-weapon="m4a1">
<img src="image/m4a1.jpg" alt="M4A1" class="weapon-img">
<span class="weapon-name">2. M4A1</span>
<span class="weapon-desc">精准 | 30发</span>
</button>
<button class="buy-btn" data-weapon="awp">
<img src="image/awp.jpg" alt="AWP" class="weapon-img">
<span class="weapon-name">3. AWP</span>
<span class="weapon-desc">狙击枪 | 10发</span>
</button>
</div>
</div>
<div id="game-over" style="display: none;">
<h2 id="winner-text">游戏结束</h2>
<p id="final-score"></p>
<button id="backToMenu" class="pixel-btn">返回主菜单</button>
</div>
</div>
<div id="cloud-map-modal" class="modal-overlay" style="display: none;">
<div class="modal-box">
<h3>☁️ 云端地图</h3>
<div id="cloud-map-loading" class="modal-status">加载中...</div>
<div id="cloud-map-error" class="modal-status error" style="display: none;"></div>
<div id="cloud-map-empty" class="modal-status" style="display: none;">暂无云端地图</div>
<div id="cloud-map-list" class="cloud-map-list"></div>
<div class="modal-actions">
<button id="cloud-map-refresh" class="pixel-btn small">🔄 刷新</button>
<button id="cloud-map-close" class="pixel-btn small">关闭</button>
</div>
</div>
</div>
<div id="quick-join-modal" class="modal-overlay" style="display: none;">
<div class="modal-box quick-join-box">
<h3>🚀 快速加入</h3>
<div class="quick-join-room-info">
<span id="quick-join-room-name"></span>
<span id="quick-join-room-mode"></span>
</div>
<div class="input-group">
<label>输入你的名称</label>
<input type="text" id="quickJoinName" placeholder="2-8个字符" maxlength="8" minlength="2">
</div>
<div class="input-group">
<label>选择阵营</label>
<div class="team-select quick-join-team">
<button type="button" id="quickJoinTeamCT" class="team-btn ct-btn active">反恐精英 (CT)</button>
<button type="button" id="quickJoinTeamT" class="team-btn t-btn">恐怖分子 (T)</button>
</div>
</div>
<div class="modal-actions">
<button id="quick-join-confirm" class="pixel-btn">加入游戏</button>
<button id="quick-join-cancel" class="pixel-btn small">取消</button>
</div>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="audio.js"></script>
<script src="map-cloud.js"></script>
<script src="maps.js"></script>
<script src="player.js"></script>
<script src="weapons.js"></script>
<script src="background.js"></script>
<script src="minimap.js"></script>
<script src="game3d.js"></script>
</body>
</html>