const MapCloudService={basePath:"/api/maps",async listMaps(){try{const t=await fetch(this.basePath);if(!t.ok)throw new Error(`HTTP ${t.status}`);return await t.json()}catch(t){throw console.error("获取地图列表失败:",t),new Error("无法连接到云端服务")}},async getMap(t){try{const o=await fetch(`${this.basePath}/${encodeURIComponent(t)}`);if(404===o.status)throw new Error("地图不存在");if(!o.ok)throw new Error(`HTTP ${o.status}`);return await o.json()}catch(t){throw console.error("获取地图失败:",t),t}},async saveMap(t,o){try{const e={...t,password:o},r=await fetch(this.basePath,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await r.json();if(!r.ok)throw new Error(a.error||`HTTP ${r.status}`);return a}catch(t){throw console.error("保存地图失败:",t),t}},async likeMap(t){try{const o=await fetch(`${this.basePath}/like`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mapId:t})}),e=await o.json();if(!o.ok)throw new Error(e.error||`HTTP ${o.status}`);return e}catch(t){throw console.error("点赞失败:",t),new Error("点赞失败，请稍后重试")}},async deleteMap(t,o){try{const e=await fetch(`${this.basePath}/${encodeURIComponent(t)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:o})}),r=await e.json();if(!e.ok)throw new Error(r.error||`HTTP ${e.status}`);return r}catch(t){throw console.error("删除地图失败:",t),t}}};"undefined"!=typeof window&&(window.MapCloudService=MapCloudService);